<div class="weather-container">
  <h2>ğŸŒ¤ï¸ Clima Actual</h2>
   
    <!-- Formulario de bÃºsqueda -->
    <div class="search-form">
      <input
        type="text"
        [(ngModel)]="city"
        placeholder="Ingresa una ciudad..."
        class="search-input"
        (keyup.enter)="searchWeather()"
      />
      <button
        (click)="searchWeather()"
        class="search-btn"
        [disabled]="loading"
      >
        {{ loading ? 'Buscando...' : 'Buscar' }}
      </button>
      <button
        (click)="getCurrentLocation()"
        class="location-btn"
        [disabled]="loading"
      >
        ğŸ“ Mi UbicaciÃ³n
      </button>
    </div>

    <!-- Mostrar errores -->
    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <!-- Mostrar loading -->
    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>Cargando informaciÃ³n del clima...</p>
    </div>

    <!-- Mostrar datos del clima ACTUALIZADO -->
    <div *ngIf="weatherData && !loading" class="weather-info">
      <div class="weather-header">
        <h3>{{ weatherData.location }}</h3>
        <img [src]="weatherData.icon" [alt]="weatherData.description" class="weather-icon">
      </div>
     
      <div class="weather-details">
        <div class="temp-main">
          <span class="temperature">{{ weatherData.temperature }}Â°C</span>
          <span class="feels-like">SensaciÃ³n {{ weatherData.feelsLike }}Â°C</span>
          <span class="description">{{ weatherData.description }}</span>
        </div>
       
        <!-- Stats bÃ¡sicos (siempre visibles) -->
        <div class="weather-stats">
          <div class="stat">
            <span class="stat-label">ğŸ’§ Humedad</span>
            <span class="stat-value">{{ weatherData.humidity }}%</span>
          </div>
          <div class="stat">
            <span class="stat-label">ğŸŒªï¸ Viento</span>
            <span class="stat-value">{{ getWindDescription() }}</span>
          </div>
          <div class="stat">
            <span class="stat-label">ğŸŒ¡ï¸ PresiÃ³n</span>
            <span class="stat-value">{{ getPressureText() }}</span>
          </div>
          <div class="stat" *ngIf="weatherData.visibility">
            <span class="stat-label">ğŸ‘ï¸ Visibilidad</span>
            <span class="stat-value">{{ getVisibilityText() }}</span>
          </div>
        </div>
      </div>

      <!-- NUEVA SECCIÃ“N: Botones de control -->
      <div class="control-buttons">
        <button 
          (click)="toggleDetailedView()" 
          class="toggle-btn"
          [class.active]="showDetailedView"
        >
          {{ showDetailedView ? 'ğŸ“Š Ocultar Detalles' : 'ğŸ“Š Ver Detalles' }}
        </button>
        <button 
          (click)="toggleForecast()" 
          class="toggle-btn"
          [class.active]="showForecast"
          [disabled]="loadingForecast"
        >
          {{ loadingForecast ? 'Cargando...' : (showForecast ? 'ğŸ“… Ocultar PronÃ³stico' : 'ğŸ“… Ver PronÃ³stico 5 DÃ­as') }}
        </button>
      </div>

      <!-- NUEVA SECCIÃ“N: Vista detallada expandible -->
      <div *ngIf="showDetailedView" class="detailed-view">
        <h4>ğŸ” InformaciÃ³n Detallada</h4>
        <div class="detailed-grid">
          <div class="detail-card">
            <h5>ğŸŒ¡ï¸ Temperatura</h5>
            <p><strong>Actual:</strong> {{ weatherData.temperature }}Â°C</p>
            <p><strong>SensaciÃ³n:</strong> {{ weatherData.feelsLike }}Â°C</p>
          </div>
          
          <div class="detail-card">
            <h5>ğŸŒªï¸ Viento</h5>
            <p><strong>Velocidad:</strong> {{ weatherData.windSpeed }} km/h</p>
            <p><strong>DirecciÃ³n:</strong> {{ weatherData.windDirection }} ({{ weatherData.windDegrees }}Â°)</p>
            <p *ngIf="weatherData.windGust"><strong>RÃ¡fagas:</strong> {{ weatherData.windGust }} km/h</p>
          </div>
          
          <div class="detail-card">
            <h5>ğŸŒ«ï¸ AtmosfÃ©rico</h5>
            <p><strong>Humedad:</strong> {{ weatherData.humidity }}%</p>
            <p><strong>PresiÃ³n:</strong> {{ weatherData.pressure }} hPa</p>
            <p *ngIf="weatherData.visibility"><strong>Visibilidad:</strong> {{ weatherData.visibility }} km</p>
          </div>
        </div>
      </div>

      <!-- NUEVA SECCIÃ“N: PronÃ³stico de 5 dÃ­as -->
      <div *ngIf="showForecast" class="forecast-section">
        <h4>ğŸ“… PronÃ³stico de 5 DÃ­as</h4>
        
        <!-- Loading del pronÃ³stico -->
        <div *ngIf="loadingForecast" class="forecast-loading">
          <div class="spinner-small"></div>
          <p>Cargando pronÃ³stico...</p>
        </div>

        <!-- Datos del pronÃ³stico -->
        <div *ngIf="forecastData && !loadingForecast" class="forecast-content">
          
          <!-- NavegaciÃ³n por dÃ­as -->
          <div class="day-tabs">
            <button 
              *ngFor="let day of forecastData.dailySummary; let i = index"
              (click)="selectDay(i)"
              class="day-tab"
              [class.active]="selectedDay === i"
            >
              <span class="day-name">{{ formatDate(day.date) }}</span>
              <span class="day-temps">{{ day.tempMin }}Â° / {{ day.tempMax }}Â°</span>
            </button>
          </div>

          <!-- Detalles del dÃ­a seleccionado -->
          <div *ngIf="getSelectedDayForecast()" class="selected-day-details">
            <div class="day-summary">
              <h5>{{ formatDate(getSelectedDayForecast()!.date) }}</h5>
              <div class="day-main-stats">
                <div class="temp-range">
                  <span class="temp-min">MÃ­n: {{ getSelectedDayForecast()!.tempMin }}Â°C</span>
                  <span class="temp-max">MÃ¡x: {{ getSelectedDayForecast()!.tempMax }}Â°C</span>
                </div>
                <div class="day-conditions">
                  <p><strong>Condiciones:</strong> {{ getSelectedDayForecast()!.dominantDescription }}</p>
                  <p><strong>Humedad promedio:</strong> {{ getSelectedDayForecast()!.avgHumidity }}%</p>
                  <p><strong>Viento mÃ¡ximo:</strong> {{ getSelectedDayForecast()!.maxWindSpeed }} km/h</p>
                  <p *ngIf="getSelectedDayForecast()!.maxWindGust">
                    <strong>RÃ¡fagas mÃ¡ximas:</strong> {{ getSelectedDayForecast()!.maxWindGust }} km/h
                  </p>
                </div>
              </div>
            </div>

            <!-- PronÃ³stico por horas del dÃ­a seleccionado (24 HORAS) -->
            <div class="hourly-forecast">
              <h6>ğŸ• PronÃ³stico por Horas (24h completas)</h6>
              
              <!-- EstadÃ­sticas rÃ¡pidas del dÃ­a -->
              <div *ngIf="getDayStats()" class="day-quick-stats">
                <div class="quick-stat">
                  <span class="stat-icon">ğŸŒ¡ï¸</span>
                  <span class="stat-text">{{ getDayStats()!.tempMin }}Â° - {{ getDayStats()!.tempMax }}Â°</span>
                </div>
                <div class="quick-stat">
                  <span class="stat-icon">ğŸŒªï¸</span>
                  <span class="stat-text">MÃ¡x: {{ getDayStats()!.maxWind }} km/h</span>
                </div>
                <div class="quick-stat">
                  <span class="stat-icon">ğŸ’§</span>
                  <span class="stat-text">Prom: {{ getDayStats()!.avgHumidity }}%</span>
                </div>
              </div>
              
              <div class="hourly-scroll">
                <div 
                  *ngFor="let hour of getFilteredHours()" 
                  class="hour-item"
                >
                  <div class="hour-time">{{ formatHour(hour.dateTime) }}</div>
                  <img [src]="hour.icon" [alt]="hour.description" class="hour-icon">
                  <div class="hour-temp">{{ hour.temperature }}Â°</div>
                  <div class="hour-feels">{{ hour.feelsLike }}Â°</div>
                  <div class="hour-desc">{{ hour.description }}</div>
                  <div class="hour-details">
                    <small>ğŸ’§ {{ hour.humidity }}%</small>
                    <small>ğŸŒªï¸ {{ hour.windSpeed }} km/h {{ hour.windDirection }}</small>
                    <small *ngIf="hour.windGust">ğŸ’¨ {{ hour.windGust }} km/h</small>
                    <small *ngIf="hour.precipitation > 0">ğŸŒ§ï¸ {{ hour.precipitation }}mm</small>
                    <small>ğŸ‘ï¸ {{ hour.visibility }}km</small>
                  </div>
                </div>
              </div>
              
              <!-- Contador de horas actualizado -->
              <div class="hours-counter">
                <small *ngIf="selectedDay === 0">
                  ğŸ“Š Mostrando {{ getFilteredHours().length }} horas desde ahora ({{ getCurrentHour() }})
                </small>
                <small *ngIf="selectedDay !== 0">
                  ğŸ“Š Mostrando {{ getFilteredHours().length }} horas completas del dÃ­a
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>

  <!-- BotÃ³n limpiar (movido al final) -->
  <button (click)="clearSearch()" class="clear-btn">
    ğŸ—‘ï¸ Limpiar BÃºsqueda
  </button>
</div>